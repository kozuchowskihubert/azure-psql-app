<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, viewport-fit=cover">
    <title>HAOS.fm - Hardware Analog Oscillator Synthesis | Electronic Music Production</title>
    
    <!-- PWA Meta Tags -->
    <meta name="description" content="HAOS.fm - Professional hardware-inspired synthesis platform. Create electronic music with authentic TB-303, TR-808, ARP 2600, and modular synthesis engines. Real analog sound in your browser.">
    <meta name="theme-color" content="#FF6B35">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    
    <!-- Icons -->
    <link rel="apple-touch-icon" sizes="180x180" href="/images/haos-logo-white.png">
    <link rel="manifest" href="/manifest.json">
    <link rel="icon" type="image/png" href="/images/haos-logo-white.png">
    
    <!-- Google Fonts - HAOS.fm Typography -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Bebas+Neue&family=Space+Mono:wght@400;700&family=Inter:wght@300;400;600;700&display=swap" rel="stylesheet">
    
    <!-- External Resources -->
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    
    <!-- HAOS.fm Brand CSS -->
    <link rel="stylesheet" href="/css/haos-brand.css">
    
    <style>
        /* HAOS.fm Landing Page Styles */
        
        /* Custom Scrollbar - Vintage Style */
        ::-webkit-scrollbar { width: 12px; }
        ::-webkit-scrollbar-track { background: var(--haos-vinyl-black); }
        ::-webkit-scrollbar-thumb { 
            background: linear-gradient(180deg, var(--haos-groove-orange), var(--haos-turntable-gold)); 
            border-radius: 6px; 
        }
        ::-webkit-scrollbar-thumb:hover {
            background: var(--haos-groove-orange);
        }
        
        /* Enhanced Monitoring Animations */
        @keyframes pulse {
            0%, 100% { opacity: 0.6; transform: scale(1); }
            50% { opacity: 1; transform: scale(1.05); }
        }
        
        @keyframes slideIn {
            from { transform: translateX(500px); opacity: 0; }
            to { transform: translateX(0); opacity: 1; }
        }
        
        @keyframes ripple {
            0% { width: 80px; height: 80px; opacity: 1; }
            100% { width: 140px; height: 140px; opacity: 0; }
        }
        
        @keyframes wave {
            0% { transform: translateX(0); }
            100% { transform: translateX(50%); }
        }
        
        @keyframes dotPulse {
            0%, 100% { transform: scale(1); opacity: 0.6; }
            50% { transform: scale(1.3); opacity: 1; box-shadow: 0 0 25px rgba(147, 112, 219, 0.9); }
        }
        
        @keyframes shimmer {
            0% { left: -100%; }
            100% { left: 100%; }
        }
        
        @keyframes float {
            0%, 100% { transform: translateY(0px); }
            50% { transform: translateY(-10px); }
        }
        
        .enhanced-card {
            transition: all 0.3s ease;
        }
        
        .enhanced-card:hover {
            transform: translateY(-5px) scale(1.02);
        }
        
        .enhanced-card:hover .metric-value {
            transform: scale(1.1);
        }
        
        /* Additional vintage effects specific to landing page */
        body {
            min-height: 100vh;
            position: relative;
        }
        
        /* Vinyl scratch overlay */
        .vinyl-scratch {
            background-image: url('data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iNTAwIiBoZWlnaHQ9IjUwMCIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj48ZGVmcz48ZmlsdGVyIGlkPSJhIj48ZmVUdXJidWxlbmNlIGJhc2VGcmVxdWVuY3k9Ii45IiBudW1PY3RhdmVzPSI0IiB0eXBlPSJmcmFjdGFsTm9pc2UiLz48ZmVDb2xvck1hdHJpeCB0eXBlPSJzYXR1cmF0ZSIgdmFsdWVzPSIwIi8+PGZlQ29tcG9uZW50VHJhbnNmZXI+PGZlRnVuY0EgdHlwZT0iZGlzY3JldGUiIHRhYmxlVmFsdWVzPSIwIDAuNSAxIi8+PC9mZUNvbXBvbmVudFRyYW5zZmVyPjwvZmlsdGVyPjwvZGVmcz48cmVjdCB3aWR0aD0iNTAwIiBoZWlnaHQ9IjUwMCIgZmlsdGVyPSJ1cmwoI2EpIiBvcGFjaXR5PSIuMDMiLz48L3N2Zz4=');
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            opacity: 0.02;
            pointer-events: none;
            mix-blend-mode: overlay;
        }
        
        /* Animated waveform */
        @keyframes waveform-pulse {
            0%, 100% { transform: scaleY(1); }
            50% { transform: scaleY(1.2); }
        }
        
        .waveform-bar {
            animation: waveform-pulse 1s ease-in-out infinite;
        }
        
        .waveform-bar:nth-child(2) { animation-delay: 0.1s; }
        .waveform-bar:nth-child(3) { animation-delay: 0.2s; }
        .waveform-bar:nth-child(4) { animation-delay: 0.3s; }
        .waveform-bar:nth-child(5) { animation-delay: 0.4s; }
        
        /* Logo glow effect */
        .logo-glow {
            filter: drop-shadow(0 0 20px rgba(255, 107, 53, 0.6));
        }
        
        /* Rotating vinyl animation */
        @keyframes vinyl-rotate {
            from { transform: rotate(0deg); }
            to { transform: rotate(360deg); }
        }
        
        .vinyl-rotating {
            animation: vinyl-rotate 8s linear infinite;
        }
        
        /* Vintage scanlines (optional - can be toggled) */
        .scanlines {
            background: linear-gradient(
                to bottom,
                transparent 50%,
                rgba(0, 0, 0, 0.05) 50%
            );
            background-size: 100% 4px;
            pointer-events: none;
        }
        
        /* Equipment rack meter animation */
        @keyframes vu-bounce {
            0%, 100% { width: 20%; }
            50% { width: 85%; }
        }
        
        .vu-animate {
            animation: vu-bounce 2s ease-in-out infinite;
        }
        
        /* Testing Dashboard Animations */
        @keyframes data-pulse {
            0%, 100% { opacity: 1; transform: scale(1); }
            50% { opacity: 0.8; transform: scale(1.02); }
        }
        
        .test-card-animate {
            animation: data-pulse 3s ease-in-out infinite;
        }
        
        /* Chart container styling */
        canvas {
            max-width: 100%;
            height: auto;
        }
        
        /* Metric counter animation */
        @keyframes counter-glow {
            0%, 100% { text-shadow: 0 0 10px currentColor; }
            50% { text-shadow: 0 0 20px currentColor; }
        }
        
        .metric-value {
            animation: counter-glow 2s ease-in-out infinite;
        }
    </style>
</head>
<body class="haos-theme">
    <div class="vinyl-scratch"></div>

    <!-- ============================================================================
         TRACK UPLOAD SECTION
         ============================================================================ -->
    <div id="track-upload-panel" style="position: fixed; top: 20px; right: 20px; z-index: 9999; width: 420px; max-width: 90vw; display: none;">
        <div style="background: linear-gradient(135deg, rgba(0,0,0,0.95), rgba(30,15,0,0.98)); border: 2px solid #FF5500; border-radius: 12px; padding: 20px; backdrop-filter: blur(10px); box-shadow: 0 10px 40px rgba(255,85,0,0.5);">
            <div style="display: flex; align-items: center; justify-content: space-between; margin-bottom: 15px;">
                <div style="display: flex; align-items: center; gap: 10px;">
                    <span style="font-size: 1.5rem;">üéß</span>
                    <span style="font-family: 'Bebas Neue', sans-serif; color: #FF5500; font-size: 1.2rem; letter-spacing: 2px;">UPLOAD TRACK</span>
                </div>
                <button id="upload-panel-close" style="background: none; border: none; color: rgba(255,255,255,0.6); cursor: pointer; font-size: 1.5rem; padding: 0; line-height: 1;">√ó</button>
            </div>
            
            <form id="track-upload-form" enctype="multipart/form-data">
                <div style="margin-bottom: 15px;">
                    <label style="display: block; color: #FF5500; font-family: 'Space Mono', monospace; font-size: 0.85rem; margin-bottom: 5px; font-weight: bold;">
                        Track Title <span style="color: rgba(255,255,255,0.4); font-size: 0.7rem;">(Optional for multiple files - will use filename)</span>
                    </label>
                    <input type="text" id="track-title" name="title"
                           minlength="1" maxlength="100"
                           style="width: 100%; padding: 10px; background: rgba(0,0,0,0.5); border: 2px solid rgba(255,85,0,0.3); border-radius: 6px; color: #fff; font-family: var(--font-mono); font-size: 0.9rem;"
                           placeholder="Enter track name or leave empty for auto-name...">
                </div>
                
                <div style="margin-bottom: 15px;">
                    <label style="display: block; color: #FF5500; font-family: 'Space Mono', monospace; font-size: 0.85rem; margin-bottom: 5px; font-weight: bold;">
                        Artist Name <span style="color: rgba(255,255,255,0.4); font-size: 0.7rem;">(Optional - defaults to "Unknown Artist")</span>
                    </label>
                    <input type="text" id="track-artist" name="artist"
                           minlength="1" maxlength="100"
                           style="width: 100%; padding: 10px; background: rgba(0,0,0,0.5); border: 2px solid rgba(255,85,0,0.3); border-radius: 6px; color: #fff; font-family: var(--font-mono); font-size: 0.9rem;"
                           placeholder="Your artist name or leave empty...">
                </div>
                
                <div style="margin-bottom: 15px;">
                    <label style="display: block; color: #FF5500; font-family: 'Space Mono', monospace; font-size: 0.85rem; margin-bottom: 5px; font-weight: bold;">Genre</label>
                    <select id="track-genre" name="genre"
                            style="width: 100%; padding: 10px; background: rgba(0,0,0,0.5); border: 2px solid rgba(255,85,0,0.3); border-radius: 6px; color: #fff; font-family: var(--font-mono); font-size: 0.9rem;">
                        <option value="Techno">Techno</option>
                        <option value="Detroit Techno">Detroit Techno</option>
                        <option value="Industrial">Industrial</option>
                        <option value="Acid House">Acid House</option>
                        <option value="Deep Techno">Deep Techno</option>
                        <option value="Minimal">Minimal</option>
                        <option value="Trap">Trap</option>
                        <option value="Electronic">Electronic</option>
                    </select>
                </div>
                
                <div style="margin-bottom: 15px;">
                    <label style="display: block; color: #FF5500; font-family: 'Space Mono', monospace; font-size: 0.85rem; margin-bottom: 5px; font-weight: bold;">Audio Files * (.mp3, .wav, .ogg) - Multiple files allowed</label>
                    <input type="file" id="track-file" name="audioFile" accept="audio/mp3,audio/wav,audio/ogg,audio/mpeg" required multiple
                           style="width: 100%; padding: 10px; background: rgba(0,0,0,0.5); border: 2px solid rgba(255,85,0,0.3); border-radius: 6px; color: #fff; font-family: var(--font-mono); font-size: 0.85rem;">
                    <div id="file-info" style="margin-top: 5px; font-size: 0.75rem; color: rgba(255,255,255,0.5); font-family: var(--font-mono);"></div>
                </div>
                
                <div style="margin-bottom: 15px;">
                    <label style="display: flex; align-items: center; gap: 8px; color: rgba(255,255,255,0.8); font-family: var(--font-mono); font-size: 0.8rem; cursor: pointer;">
                        <input type="checkbox" id="track-copyright" name="copyright" required
                               style="width: 18px; height: 18px; cursor: pointer;">
                        <span>I own the copyright to these tracks *</span>
                    </label>
                    <div style="margin-top: 4px; font-size: 0.7rem; color: rgba(255,255,255,0.4); font-family: var(--font-mono); padding-left: 26px;">
                        Required for single or multiple file uploads
                    </div>
                </div>
                
                <div id="upload-status" style="margin-bottom: 10px; padding: 10px; background: rgba(0,0,0,0.3); border-radius: 6px; display: none; font-family: var(--font-mono); font-size: 0.85rem;"></div>
                
                <button type="submit" id="upload-submit-btn"
                        style="width: 100%; padding: 12px; background: linear-gradient(135deg, #FF5500, #FF8833); border: none; border-radius: 6px; color: white; font-weight: bold; cursor: pointer; font-family: 'Bebas Neue', sans-serif; font-size: 1.1rem; letter-spacing: 1px; box-shadow: 0 4px 15px rgba(255,85,0,0.4); transition: all 0.2s;">
                    üéµ UPLOAD TRACK
                </button>
            </form>
        </div>
    </div>

    <!-- ============================================================================
         EUPHONY ASSISTANT - Hidden from basic view
         ============================================================================ -->
    <div id="euphony-assistant" style="position: fixed; bottom: 20px; left: 20px; z-index: 9999; width: 400px; max-width: 90vw; display: none;">
        <!-- Euphony Panel -->
        <div id="euphony-panel" style="background: linear-gradient(135deg, rgba(0,0,0,0.95), rgba(20,10,30,0.98)); border: 2px solid #9370DB; border-radius: 12px; padding: 15px; backdrop-filter: blur(10px); box-shadow: 0 10px 40px rgba(147,112,219,0.4);">
            <div style="display: flex; align-items: center; justify-content: space-between; margin-bottom: 10px;">
                <div style="display: flex; align-items: center; gap: 10px;">
                    <div style="width: 36px; height: 36px; background: linear-gradient(135deg, #9370DB, #BA55D3); border-radius: 50%; display: flex; align-items: center; justify-content: center; font-size: 1.3rem; animation: pulse 2s infinite; box-shadow: 0 0 20px rgba(147,112,219,0.5);">
                        üéµ
                    </div>
                    <span style="font-family: 'Space Mono', monospace; color: #BA55D3; font-size: 1rem; letter-spacing: 2px; font-weight: bold;">EUPHONY AI</span>
                </div>
                <button id="euphony-minimize" style="background: none; border: none; color: rgba(255,255,255,0.6); cursor: pointer; font-size: 1.2rem; padding: 0; width: 24px; height: 24px;" title="Minimize">
                    <i class="fas fa-minus"></i>
                </button>
            </div>
            
            <div id="euphony-chat" style="max-height: 250px; overflow-y: auto; margin-bottom: 10px; padding: 12px; background: rgba(0,0,0,0.4); border-radius: 8px; font-family: var(--font-mono); font-size: 0.85rem;">
                <div class="euphony-message" style="color: #BA55D3; margin-bottom: 10px; line-height: 1.6;">
                    <strong>üéµ Euphony:</strong> Welcome to HAOS intelligent music system! I have access to <strong>50+ presets</strong>, <strong>26 tracks</strong>, and <strong>6 curated playlists</strong> including <strong>SoundCloud Radio</strong>! You can also <strong>upload your own tracks</strong>! Subscribe to <a href="https://www.youtube.com/@haos_" target="_blank" style="color: #FF0000; text-decoration: underline;">YouTube @haos_</a> for more!
                </div>
                <div style="color: rgba(255,255,255,0.75); margin-left: 20px; font-size: 0.8rem; line-height: 1.8;">
                    <strong style="color: #9370DB;">üéµ Playlists:</strong><br>
                    ‚Ä¢ "soundcloud" / "radio" - SoundCloud Radio Player üéß<br>
                    ‚Ä¢ "uploaded" / "my tracks" - Your uploaded tracks üìÅ<br>
                    ‚Ä¢ "haos" / "exclusive" - HAOS Exclusive (6 tracks)<br>
                    ‚Ä¢ "detroit" / "techno" - Technobot Detroit (5 tracks)<br>
                    ‚Ä¢ "industrial" - Industrial Techno (5 tracks)<br>
                    ‚Ä¢ "acid" / "classics" - Acid Classics (4 tracks)<br>
                    ‚Ä¢ "deep" - Deep Techno (4 tracks)<br><br>
                    
                    <strong style="color: #9370DB;">üéπ Synth Presets:</strong><br>
                    ‚Ä¢ "show tb303" - TB-303 presets (17)<br>
                    ‚Ä¢ "show arp2600" - ARP 2600 patches (14)<br>
                    ‚Ä¢ "show tr909" - TR-909 kits (9)<br>
                    ‚Ä¢ "show tr808" - TR-808 kits (10)<br><br>
                    
                    <strong style="color: #9370DB;">‚ö° Commands:</strong><br>
                    ‚Ä¢ "play soundcloud" - SoundCloud Radio üéß<br>
                    ‚Ä¢ "rave rage" - Play the hit! üî•<br>
                    ‚Ä¢ "next" / "prev" - Navigate<br>
                    ‚Ä¢ "shuffle" - Randomize queue<br>
                    ‚Ä¢ "volume [0-100]" - Adjust level
                </div>
            </div>
            
            <div style="display: flex; gap: 5px;">
                <input id="euphony-input" type="text" placeholder="Ask Euphony..." style="flex: 1; padding: 10px 12px; background: rgba(0,0,0,0.5); border: 2px solid #9370DB; border-radius: 6px; color: #fff; font-family: var(--font-mono); font-size: 0.85rem;" />
                <button id="euphony-send" style="padding: 10px 16px; background: linear-gradient(135deg, #9370DB, #BA55D3); border: none; border-radius: 6px; color: #fff; font-weight: bold; cursor: pointer; font-family: var(--font-mono); box-shadow: 0 4px 12px rgba(147,112,219,0.3);">
                    ASK
                </button>
            </div>
            
            <div style="margin-top: 10px; display: flex; flex-wrap: wrap; gap: 5px;">
                <button class="euphony-quick-btn" data-command="play soundcloud" style="background: rgba(255, 85, 0, 0.2); border-color: #FF5500;">üéß SoundCloud</button>
                <button class="euphony-quick-btn" data-command="play haos">üéµ HAOS</button>
                <button class="euphony-quick-btn" data-command="play detroit">‚ö° Detroit</button>
                <button class="euphony-quick-btn" data-command="play acid">üß™ Acid</button>
                <button class="euphony-quick-btn" data-command="show arp2600">üéπ ARP</button>
                <button class="euphony-quick-btn" data-command="next">‚è≠Ô∏è Next</button>
                <button class="euphony-quick-btn" data-command="status">üìä Status</button>
            </div>
        </div>
        
        <!-- Minimized state -->
        <div id="euphony-minimized" style="display: none; background: linear-gradient(135deg, #9370DB, #BA55D3); border-radius: 50%; width: 65px; height: 65px; display: flex; align-items: center; justify-content: center; cursor: pointer; box-shadow: 0 5px 25px rgba(147,112,219,0.6); animation: pulse 2s infinite;">
            <span style="font-size: 2.2rem;">üéµ</span>
        </div>
    </div>

    <style>
        .euphony-quick-btn {
            padding: 6px 12px;
            background: rgba(147, 112, 219, 0.2);
            border: 1px solid #9370DB;
            border-radius: 6px;
            color: #BA55D3;
            font-size: 0.75rem;
            cursor: pointer;
            font-family: var(--font-mono);
            transition: all 0.3s;
        }
        .euphony-quick-btn:hover {
            background: linear-gradient(135deg, #9370DB, #BA55D3);
            color: #fff;
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(147,112,219,0.4);
        }
        #euphony-chat::-webkit-scrollbar {
            width: 6px;
        }
        #euphony-chat::-webkit-scrollbar-track {
            background: rgba(0,0,0,0.3);
        }
        #euphony-chat::-webkit-scrollbar-thumb {
            background: linear-gradient(180deg, #9370DB, #BA55D3);
            border-radius: 3px;
        }
    </style>

    <!-- ============================================================================
         BACKGROUND MUSIC PLAYER - Hidden by default
         ============================================================================ -->
    <div id="haos-bg-music-player" class="haos-radio-player" style="position: fixed; bottom: 20px; right: 20px; z-index: 9999; width: 400px; max-width: 90vw; display: none; transition: all 0.5s cubic-bezier(0.4, 0, 0.2, 1);">
        
        <!-- Minimized State -->
        <div id="haos-radio-minimized" class="haos-radio-minimized" style="display: none; background: linear-gradient(135deg, rgba(0,0,0,0.95), rgba(20,20,20,0.98)); border: 2px solid var(--haos-orange-primary); border-radius: 50px; padding: 12px 20px; backdrop-filter: blur(10px); box-shadow: 0 4px 20px rgba(255,107,53,0.4); cursor: pointer; transition: all 0.3s;">
            <div style="display: flex; align-items: center; gap: 12px;">
                <div style="width: 10px; height: 10px; background: #39FF14; border-radius: 50%; animation: pulse 2s infinite; box-shadow: 0 0 10px #39FF14;"></div>
                <div style="flex: 1; min-width: 0;">
                    <div id="haos-mini-title" style="font-family: var(--font-display); color: #fff; font-size: 0.9rem; white-space: nowrap; overflow: hidden; text-overflow: ellipsis; font-weight: bold;">
                        Loading...
                    </div>
                    <div id="haos-mini-artist" style="font-family: var(--font-mono); color: rgba(255,255,255,0.6); font-size: 0.7rem;">
                        HAOS Radio
                    </div>
                </div>
                <button id="haos-mini-playpause" style="background: rgba(255, 107, 53, 0.3); border: 2px solid var(--haos-orange-primary); border-radius: 50%; color: var(--haos-orange-primary); cursor: pointer; width: 36px; height: 36px; display: flex; align-items: center; justify-content: center; transition: all 0.3s; font-size: 0.9rem;">
                    <i class="fas fa-pause"></i>
                </button>
            </div>
        </div>
        
        <!-- Expanded State (Full Control Panel) -->
        <div id="haos-music-controls" class="haos-radio-expanded" style="background: linear-gradient(135deg, rgba(0,0,0,0.95), rgba(20,20,20,0.98)); border: 2px solid var(--haos-orange-primary); border-radius: 12px; padding: 15px; backdrop-filter: blur(10px); box-shadow: 0 10px 40px rgba(255,107,53,0.3); transition: all 0.3s;">
            <div style="display: flex; align-items: center; justify-content: space-between; margin-bottom: 10px;">
                <div style="display: flex; align-items: center; gap: 10px;">
                    <div style="width: 8px; height: 8px; background: #39FF14; border-radius: 50%; animation: pulse 2s infinite;"></div>
                    <span style="font-family: 'Space Mono', monospace; color: var(--haos-orange-primary); font-size: 0.75rem; letter-spacing: 2px; font-weight: bold;">üìª HAOS RADIO</span>
                </div>
                <button id="haos-music-close" style="background: none; border: none; color: rgba(255,255,255,0.6); cursor: pointer; font-size: 1.2rem; padding: 0; width: 24px; height: 24px;" title="Close player">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            
            <div id="haos-track-info" style="margin-bottom: 12px;">
                <div id="haos-track-title" style="font-family: var(--font-display); color: #fff; font-size: 1rem; margin-bottom: 4px; white-space: nowrap; overflow: hidden; text-overflow: ellipsis;">
                    Loading...
                </div>
                <div id="haos-track-artist" style="font-family: var(--font-mono); color: rgba(255,255,255,0.6); font-size: 0.85rem;">
                    HAOS Radio
                </div>
            </div>
            
            <div style="display: flex; align-items: center; gap: 10px; margin-bottom: 10px;">
                <button id="haos-music-prev" class="haos-music-btn" title="Previous">
                    <i class="fas fa-step-backward"></i>
                </button>
                <button id="haos-music-playpause" class="haos-music-btn haos-music-btn-large" title="Play/Pause">
                    <i class="fas fa-pause"></i>
                </button>
                <button id="haos-music-next" class="haos-music-btn" title="Next">
                    <i class="fas fa-step-forward"></i>
                </button>
                <div style="flex: 1; height: 4px; background: rgba(255,255,255,0.1); border-radius: 2px; position: relative; margin: 0 10px;">
                    <div id="haos-music-progress" style="height: 100%; background: linear-gradient(90deg, var(--haos-orange-primary), #FFD700); border-radius: 2px; width: 0%; transition: width 0.3s;"></div>
                </div>
                <input id="haos-music-volume" type="range" min="0" max="100" value="70" style="width: 80px; cursor: pointer;" title="Volume">
            </div>
            
            <div style="display: flex; align-items: center; justify-content: center; gap: 12px; margin-top: 10px;">
                <a href="https://www.youtube.com/@haos_" target="_blank" rel="noopener noreferrer" 
                   style="display: flex; align-items: center; gap: 6px; font-family: var(--font-mono); font-size: 0.7rem; color: #FF0000; text-decoration: none; background: rgba(255,0,0,0.1); padding: 6px 12px; border-radius: 6px; border: 1px solid rgba(255,0,0,0.3); transition: all 0.3s;"
                   onmouseover="this.style.background='rgba(255,0,0,0.2)'; this.style.borderColor='#FF0000';"
                   onmouseout="this.style.background='rgba(255,0,0,0.1)'; this.style.borderColor='rgba(255,0,0,0.3)';">
                    <i class="fab fa-youtube"></i>
                    <span>@haos_</span>
                </a>
                <button id="open-upload-btn" 
                   style="display: flex; align-items: center; gap: 6px; font-family: var(--font-mono); font-size: 0.7rem; color: #FF5500; text-decoration: none; background: rgba(255,85,0,0.1); padding: 6px 12px; border-radius: 6px; border: 1px solid rgba(255,85,0,0.3); transition: all 0.3s; cursor: pointer;"
                   onmouseover="this.style.background='rgba(255,85,0,0.2)'; this.style.borderColor='#FF5500';"
                   onmouseout="this.style.background='rgba(255,85,0,0.1)'; this.style.borderColor='rgba(255,85,0,0.3)';">
                    <span>‚¨ÜÔ∏è</span>
                    <span>UPLOAD TRACK</span>
                </button>
            </div>
            
            <div style="font-family: var(--font-mono); font-size: 0.7rem; color: rgba(255,255,255,0.4); text-align: center; margin-top: 8px;">
                üéµ Streaming Quality Audio
            </div>
        </div>
    </div>

    <style>
        .haos-music-btn {
            background: rgba(255, 107, 53, 0.2);
            border: 2px solid var(--haos-orange-primary);
            border-radius: 8px;
            color: var(--haos-orange-primary);
            cursor: pointer;
            padding: 8px 12px;
            font-size: 0.9rem;
            transition: all 0.3s;
        }
        .haos-music-btn:hover {
            background: var(--haos-orange-primary);
            color: #000;
            transform: translateY(-2px);
        }
        .haos-music-btn-large {
            padding: 12px 20px;
            font-size: 1.1rem;
        }
        #haos-music-volume {
            -webkit-appearance: none;
            appearance: none;
            height: 4px;
            background: rgba(255,255,255,0.1);
            border-radius: 2px;
            outline: none;
        }
        #haos-music-volume::-webkit-slider-thumb {
            -webkit-appearance: none;
            appearance: none;
            width: 12px;
            height: 12px;
            background: var(--haos-orange-primary);
            border-radius: 50%;
            cursor: pointer;
        }
        #haos-music-volume::-moz-range-thumb {
            width: 12px;
            height: 12px;
            background: var(--haos-orange-primary);
            border-radius: 50%;
            cursor: pointer;
            border: none;
        }
    </style>

    <!-- ============================================================================
         NAVIGATION HEADER - HAOS.fm BRANDED
         ============================================================================ -->
    <header class="haos-card-glass sticky top-0 z-50" style="backdrop-filter: blur(20px);">
        <div class="haos-container">
            <div class="flex items-center justify-between h-20">
                <!-- HAOS.fm Logo -->
                <div class="flex items-center space-x-4">
                    <img src="/images/haos-logo-white.png" alt="HAOS.fm" class="h-10 vinyl-rotating logo-glow" style="width: auto;">
                    <div>
                        <h1 class="haos-display-sm haos-text-gradient-orange" style="font-size: 1.5rem; line-height: 1;">
                            HAOS.fm
                        </h1>
                        <p class="haos-mono" style="font-size: 0.65rem; color: var(--haos-dust-gray); letter-spacing: 0.15em;">
                            HARDWARE ANALOG OSCILLATOR SYNTHESIS
                        </p>
                    </div>
                </div>
                
                <!-- Navigation -->
                <nav class="hidden md:flex items-center space-x-6">
                    <a href="/haos-platform.html" class="haos-label hover:text-orange-400 transition-colors" style="font-size: 1.1em; font-weight: bold;">
                        <i class="fas fa-cubes mr-2"></i>HAOS PLATFORM
                    </a>
                    <a href="/techno-workspace.html" class="haos-label hover:text-orange-400 transition-colors" style="font-size: 1.1em; font-weight: bold;">
                        <i class="fas fa-project-diagram mr-2"></i>WORKSPACE
                    </a>
                    <a href="#features" class="haos-label hover:text-orange-400 transition-colors">
                        <i class="fas fa-star mr-2"></i>FEATURES
                    </a>
                    <a href="/platform/studio.html#radio" class="haos-label transition-colors flex items-center gap-2" style="color: #39FF14; font-weight: bold;">
                        <i class="fas fa-broadcast-tower"></i>RADIO
                        <span class="haos-badge" style="background: linear-gradient(135deg, #39FF14, #00FF00); color: #000; font-weight: 700; font-size: 0.7em; padding: 2px 8px;">LIVE</span>
                    </a>
                    <a href="https://www.youtube.com/@haos_" target="_blank" rel="noopener noreferrer" class="haos-label transition-colors flex items-center gap-2" style="color: #FF0000; font-weight: bold;" title="Watch on YouTube">
                        <i class="fab fa-youtube"></i>@haos_
                    </a>
                </nav>
                
                <!-- Mobile Menu -->
                <button class="md:hidden haos-btn-secondary px-4 py-2">
                    <i class="fas fa-bars"></i>
                </button>
            </div>
        </div>
    </header>

    <!-- ============================================================================
         HERO SECTION - VINTAGE VINYL AESTHETIC
         ============================================================================ -->
    <section class="haos-section" style="background: linear-gradient(180deg, var(--haos-vinyl-black) 0%, var(--haos-tape-brown) 100%); position: relative; overflow: hidden;">
        <!-- Animated waveform background -->
        <div style="position: absolute; bottom: 0; left: 0; width: 100%; height: 200px; display: flex; align-items: flex-end; justify-content: center; gap: 4px; opacity: 0.1;">
            <div class="waveform-bar" style="width: 8px; height: 60%; background: var(--haos-groove-orange);"></div>
            <div class="waveform-bar" style="width: 8px; height: 80%; background: var(--haos-groove-orange);"></div>
            <div class="waveform-bar" style="width: 8px; height: 40%; background: var(--haos-groove-orange);"></div>
            <div class="waveform-bar" style="width: 8px; height: 90%; background: var(--haos-groove-orange);"></div>
            <div class="waveform-bar" style="width: 8px; height: 70%; background: var(--haos-groove-orange);"></div>
            <div class="waveform-bar" style="width: 8px; height: 50%; background: var(--haos-groove-orange);"></div>
            <div class="waveform-bar" style="width: 8px; height: 85%; background: var(--haos-groove-orange);"></div>
            <div class="waveform-bar" style="width: 8px; height: 65%; background: var(--haos-groove-orange);"></div>
        </div>
        
        <div class="haos-container text-center haos-slide-up" style="position: relative; z-index: 10;">
            <!-- Main Logo - Your Custom PNG -->
            <div class="mb-8" style="max-width: 800px; margin: 0 auto;">
                <img src="/images/haos-logo-white.png" alt="HAOS.fm - Hardware Analog Oscillator Synthesis" class="w-full logo-glow" style="max-width: 600px; margin: 0 auto;">
            </div>
            
            <h2 class="haos-display-md haos-text-gradient-gold mb-4">
                HARDWARE ANALOG SYNTHESIS
            </h2>
            
            <p class="haos-body-lg mb-8 max-w-3xl mx-auto" style="color: var(--haos-sepia-cream);">
                Create electronic music with authentic hardware-inspired synthesis engines. 
                <br>TB-303 acid bass, TR-909 drums, 16-step sequencer, and live modular workspace.
            </p>
            
            <div class="flex flex-wrap justify-center gap-4 mb-12">
                <a href="/haos-platform.html" class="haos-btn haos-btn-primary" style="font-size: 1.2em; padding: 18px 36px; background: linear-gradient(135deg, #FF6B35, #FF8C42);">
                    üéõÔ∏è ENTER HAOS PLATFORM
                </a>
                <a href="/techno-workspace.html" class="haos-btn haos-btn-primary" style="font-size: 1.2em; padding: 18px 36px;">
                    üîß MODULAR WORKSPACE
                </a>
                <!-- Legacy Radio 24/7 button - hidden (we have live radio player now) -->
                <a href="/radio.html" class="haos-btn haos-btn-secondary" style="display: none; background: linear-gradient(135deg, #39FF14, #00FF00); color: #000; font-weight: 700;">
                    üìª RADIO 24/7
                </a>
            </div>
            
            <!-- Stats - Equipment Rack Style -->
            <div class="haos-rack" style="max-width: 900px; margin: var(--haos-space-3xl) auto 0;">
                <div class="haos-rack-strip"></div>
                <div class="grid grid-cols-2 md:grid-cols-4 gap-6 mt-6">
                    <div class="text-center">
                        <div class="haos-vu-meter mb-3">
                            <div class="haos-vu-fill vu-animate" style="width: 85%;"></div>
                        </div>
                        <div class="haos-display-md haos-text-gradient-orange">10+</div>
                        <div class="haos-label" style="color: var(--haos-sepia-cream);">SYNTHESIS TOOLS</div>
                    </div>
                    <div class="text-center">
                        <div class="haos-vu-meter mb-3">
                            <div class="haos-vu-fill vu-animate" style="width: 75%; animation-delay: 0.2s;"></div>
                        </div>
                        <div class="haos-display-md haos-text-gradient-orange">5+</div>
                        <div class="haos-label" style="color: var(--haos-sepia-cream);">ANALOG OSCILLATORS</div>
                    </div>
                    <div class="text-center">
                        <div class="haos-vu-meter mb-3">
                            <div class="haos-vu-fill vu-animate" style="width: 100%; animation-delay: 0.4s;"></div>
                        </div>
                        <div class="haos-display-md haos-text-gradient-orange">24/7</div>
                        <div class="haos-label" style="color: var(--haos-sepia-cream);">LIVE BROADCAST</div>
                    </div>
                    <div class="text-center">
                        <div class="haos-vu-meter mb-3">
                            <div class="haos-vu-fill vu-animate" style="width: 95%; animation-delay: 0.6s;"></div>
                        </div>
                        <div class="haos-display-md haos-text-gradient-orange">‚àû</div>
                        <div class="haos-label" style="color: var(--haos-sepia-cream);">SONIC CHAOS</div>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- ============================================================================
         SYNTHESIS STUDIOS
         ============================================================================ -->
    <main class="haos-container py-12">

        <!-- ========================================================================
             MUSIC CREATION
             ======================================================================== -->
        <section id="studios" class="haos-section">
            <div class="text-center mb-12">
                <h2 class="haos-display-lg mb-4" style="background: linear-gradient(135deg, #39FF14, #00D9FF); -webkit-background-clip: text; -webkit-text-fill-color: transparent;">
                    SYNTHESIS STUDIOS
                </h2>
                <p class="haos-body-lg" style="color: var(--haos-sepia-cream);">
                    Hardware-inspired music creation with complete track integration
                </p>
            </div>

            <!-- FEATURED: HAOS Platform - Dual OS System -->
            <div class="mb-12">
                <a href="/haos-platform.html" class="haos-studio-card block" style="border: 3px solid #FF6B35; box-shadow: 0 0 40px rgba(255, 107, 53, 0.5); background: linear-gradient(135deg, rgba(255, 107, 53, 0.15), rgba(255, 140, 66, 0.1));">
                    <div class="flex items-start justify-between mb-6">
                        <div class="text-6xl">üéõÔ∏è</div>
                        <span class="haos-badge haos-badge-new" style="background: linear-gradient(135deg, #FF6B35, #FF8C42); color: #000; font-size: 1.2rem; padding: 0.5rem 1rem;">HAOS PLATFORM</span>
                    </div>
                    <h3 class="text-4xl md:text-5xl font-bold mb-4" style="background: linear-gradient(135deg, #FF6B35, #FF8C42); -webkit-background-clip: text; -webkit-text-fill-color: transparent; background-clip: text;">
                        HAOS Platform & Workspace
                    </h3>
                    <p class="text-xl haos-body mb-6" style="color: var(--haos-sepia-cream);">
                        Complete modular synthesis environment with <strong>TB-303 Acid Bass</strong>, <strong>TR-909 Drums</strong>, <strong>16-Step Sequencer</strong>, and <strong>Visual Patch Routing</strong>. Build your sonic architecture with hardware-inspired workflow.
                    </p>
                    <div class="flex flex-wrap gap-3 mb-4">
                        <span class="haos-tag text-lg" style="background: rgba(255, 107, 53, 0.2); color: #FF8C42; padding: 0.5rem 1rem;">üß™ TB-303 ACID</span>
                        <span class="haos-tag text-lg" style="background: rgba(255, 107, 53, 0.2); color: #FF8C42; padding: 0.5rem 1rem;">ü•Å TR-909 DRUMS</span>
                        <span class="haos-tag text-lg" style="background: rgba(255, 107, 53, 0.2); color: #FF8C42; padding: 0.5rem 1rem;">‚è±Ô∏è SEQUENCER</span>
                        <span class="haos-tag text-lg" style="background: rgba(255, 107, 53, 0.2); color: #FF8C42; padding: 0.5rem 1rem;">üîå PATCH MATRIX</span>
                    </div>
                    <div class="text-2xl font-bold" style="color: #FF6B35;">
                        ‚ñ∂ LAUNCH HAOS PLATFORM
                    </div>
                </a>
            </div>

            <!-- SECONDARY: Radio - Hidden from main page -->
            <div class="haos-grid haos-grid-2 mb-12" style="display: none;">
                <a href="/radio.html" class="haos-studio-card">
                    <div class="flex items-start justify-between mb-4">
                        <div class="text-5xl"><i class="fas fa-broadcast-tower" style="color: #39FF14;"></i></div>
                        <span class="haos-badge" style="background: linear-gradient(135deg, #39FF14, #00FF00); color: #000; font-weight: 700;">LIVE</span>
                    </div>
                    <h3 class="text-3xl font-bold mb-3" style="color: #39FF14;">
                        HAOS.FM RADIO 24/7
                    </h3>
                    <p class="haos-body" style="color: var(--haos-sepia-cream); margin-bottom: var(--haos-space-md);">
                        Non-stop streaming with live visualization. Listen to community tracks and share your creations.
                    </p>
                    <div class="flex flex-wrap gap-2">
                        <span class="haos-tag" style="background: rgba(57, 255, 20, 0.2); color: #39FF14;">LIVE STREAM</span>
                        <span class="haos-tag" style="background: rgba(57, 255, 20, 0.2); color: #39FF14;">VISUALIZER</span>
                        <span class="haos-tag" style="background: rgba(57, 255, 20, 0.2); color: #39FF14;">24/7</span>
                    </div>
                </a>
            </div>

            <!-- Complete Production Suite - SIMPLIFIED -->
            <div class="mt-12">
                <div class="text-center mb-8">
                    <h3 class="text-3xl font-bold mb-3" style="background: linear-gradient(135deg, #FF6B35, #FF8C42); -webkit-background-clip: text; -webkit-text-fill-color: transparent;">
                        Professional Synthesis Tools
                    </h3>
                    <p class="text-lg" style="color: var(--haos-sepia-cream);">
                        Curated selection of hardware-inspired synthesis platforms
                    </p>
                </div>

                <!-- Strategic Studios Only -->
                <div class="haos-grid haos-grid-2 gap-6">
                    <!-- Modular Workspace -->
                    <a href="/techno-workspace.html" class="haos-studio-card hover:scale-105 transition-all">
                        <div class="flex items-start justify-between mb-3">
                            <div class="text-5xl"><i class="fas fa-project-diagram" style="color: #FF6B35;"></i></div>
                            <span class="haos-badge" style="background: linear-gradient(135deg, #FF6B35, #FF8C42); color: #000; font-weight: 700;">MODULAR</span>
                        </div>
                        <h5 class="text-2xl font-bold mb-2" style="color: #FF6B35;">Modular Workspace</h5>
                        <p class="haos-body text-sm mb-3">Eurorack-inspired modular environment with drag-and-drop patch cables, CV routing, and real-time signal flow visualization</p>
                        <div class="flex flex-wrap gap-2">
                            <span class="haos-tag text-xs">PATCH CABLES</span>
                            <span class="haos-tag text-xs">CV ROUTING</span>
                            <span class="haos-tag text-xs">VISUAL FLOW</span>
                        </div>
                    </a>

                    <!-- ARP 2600 Studio -->
                    <a href="/synth-2600-studio.html" class="haos-studio-card hover:scale-105 transition-all">
                        <div class="flex items-start justify-between mb-3">
                            <div class="text-5xl"><i class="fas fa-sliders-h" style="color: #FF6B35;"></i></div>
                            <span class="haos-badge" style="background: linear-gradient(135deg, #FF6B35, #FF8C42); color: #000; font-weight: 700;">CLASSIC</span>
                        </div>
                        <h5 class="text-2xl font-bold mb-2" style="color: #FF6B35;">ARP 2600 Studio</h5>
                        <p class="haos-body text-sm mb-3">Legendary modular synthesizer with complete patch matrix</p>
                        <div class="flex flex-wrap gap-2">
                            <span class="haos-tag text-xs">VINTAGE</span>
                            <span class="haos-tag text-xs">ANALOG</span>
                            <span class="haos-tag text-xs">MODULAR</span>
                        </div>
                    </a>

                    <!-- Unified Studio -->
                    <a href="/platform/studio.html" class="haos-studio-card hover:scale-105 transition-all">
                        <div class="flex items-start justify-between mb-3">
                            <div class="text-5xl"><i class="fas fa-th-large" style="color: #FF6B35;"></i></div>
                            <span class="haos-badge" style="background: linear-gradient(135deg, #FF6B35, #FF8C42); color: #000; font-weight: 700;">UNIFIED</span>
                        </div>
                        <h5 class="text-2xl font-bold mb-2" style="color: #FF6B35;">Unified Studio</h5>
                        <p class="haos-body text-sm mb-3">All-in-one production suite with TB-303, TR-909, and radio</p>
                        <div class="flex flex-wrap gap-2">
                            <span class="haos-tag text-xs">ALL-IN-ONE</span>
                            <span class="haos-tag text-xs">RADIO</span>
                            <span class="haos-tag text-xs">COLLAB</span>
                        </div>
                    </a>

                    <!-- Patch Sequencer -->
                    <a href="/synth-patch-sequencer.html" class="haos-studio-card hover:scale-105 transition-all">
                        <div class="flex items-start justify-between mb-3">
                            <div class="text-5xl"><i class="fas fa-sitemap" style="color: #FF6B35;"></i></div>
                            <span class="haos-badge" style="background: linear-gradient(135deg, #FF6B35, #FF8C42); color: #000; font-weight: 700;">ADVANCED</span>
                        </div>
                        <h5 class="text-2xl font-bold mb-2" style="color: #FF6B35;">Patch Sequencer</h5>
                        <p class="haos-body text-sm mb-3">Advanced 16-step sequencer with visual patch matrix, parameter automation, and modulation routing for complex generative patterns</p>
                        <div class="flex flex-wrap gap-2">
                            <span class="haos-tag text-xs">16-STEP SEQ</span>
                            <span class="haos-tag text-xs">AUTOMATION</span>
                            <span class="haos-tag text-xs">MODULATION</span>
                        </div>
                    </a>
                </div>
            </div>

        </section>

    </main>

    <!-- Scripts -->
    <script>
        // ============================================
        // DARK MODE / LIGHT MODE TOGGLE
        // ============================================
        
        const themeToggle = document.getElementById('theme-toggle');
        const themeIcon = themeToggle.querySelector('i');
        
        // Load saved theme preference or default to dark
        const savedTheme = localStorage.getItem('theme') || 'dark';
        
        function setTheme(theme) {
            if (theme === 'light') {
                document.body.classList.add('light-mode');
                themeIcon.classList.remove('fa-moon');
                themeIcon.classList.add('fa-sun');
                localStorage.setItem('theme', 'light');
            } else {
                document.body.classList.remove('light-mode');
                themeIcon.classList.remove('fa-sun');
                themeIcon.classList.add('fa-moon');
                localStorage.setItem('theme', 'dark');
            }
        }
        
        // Apply saved theme on load
        setTheme(savedTheme);
        
        // Toggle theme on button click
        themeToggle.addEventListener('click', () => {
            const currentTheme = document.body.classList.contains('light-mode') ? 'light' : 'dark';
            const newTheme = currentTheme === 'dark' ? 'light' : 'dark';
            setTheme(newTheme);
            
            // Show toast notification
            const toast = document.createElement('div');
            toast.style.cssText = `
                position: fixed;
                top: 80px;
                right: 20px;
                background: linear-gradient(135deg, #667eea, #764ba2);
                color: white;
                padding: 12px 24px;
                border-radius: 8px;
                box-shadow: 0 4px 12px rgba(0,0,0,0.3);
                z-index: 9999;
                animation: slideIn 0.3s ease-out;
            `;
            toast.textContent = `${newTheme === 'light' ? '‚òÄÔ∏è' : 'üåô'} ${newTheme === 'light' ? 'Light' : 'Dark'} mode activated`;
            document.body.appendChild(toast);
            
            setTimeout(() => {
                toast.style.animation = 'fadeOut 0.3s ease-out';
                setTimeout(() => toast.remove(), 300);
            }, 2000);
        });
        
        // ============================================
        // SMOOTH SCROLL
        // ============================================
        
        // Smooth Scroll
        document.querySelectorAll('a[href^="#"]').forEach(anchor => {
            anchor.addEventListener('click', function (e) {
                e.preventDefault();
                const target = document.querySelector(this.getAttribute('href'));
                if (target) {
                    target.scrollIntoView({ behavior: 'smooth', block: 'start' });
                }
            });
        });
        
        // ============================================
        // SCROLL ANIMATIONS
        // ============================================
        
        // Animate on scroll
        const observerOptions = {
            threshold: 0.1,
            rootMargin: '0px 0px -50px 0px'
        };
        
        const observer = new IntersectionObserver((entries) => {
            entries.forEach(entry => {
                if (entry.isIntersecting) {
                    entry.target.style.opacity = '1';
                    entry.target.style.transform = 'translateY(0)';
                }
            });
        }, observerOptions);
        
        document.querySelectorAll('.feature-card').forEach(card => {
            card.style.opacity = '0';
            card.style.transform = 'translateY(30px)';
            card.style.transition = 'all 0.6s ease-out';
            observer.observe(card);
        });
    </script>

    <!-- HAOS State Manager for Cross-Page Integration -->
    <script src="/js/state-manager.js"></script>
    <script src="/js/system-monitor.js"></script>
    
    <script>
        console.log('üéõÔ∏è HAOS.fm Platform - State Manager Active');
        
        // Listen for cross-page state updates
        window.addEventListener('haos:state-synced', (e) => {
            console.log('üì° State synced:', e.detail);
        });

        // Track page analytics
        window.HAOSState.updateSettings({
            lastVisit: new Date().toISOString(),
            landingPage: 'index'
        });
    </script>

    <!-- HAOS Background Radio Player - Integrated with Studio Radio -->
    <script>
        window.HAOS_BG_RADIO = {
            audioContext: null,
            oscillator: null,
            gainNode: null,
            isPlaying: false,
            currentTrackIndex: 0,
            currentPlaylist: 'technobot-detroit',
            volume: 70,
            
            // Import playlists from Studio Radio system
            playlists: {
                'technobot-detroit': [
                    { title: 'HAOS - Rave Rage', artist: 'HAOS', duration: 420, url: 'https://www.soundhelix.com/examples/mp3/SoundHelix-Song-1.mp3' },
                    { title: 'HAOS - Techno Track', artist: 'HAOS', duration: 360, url: 'https://www.soundhelix.com/examples/mp3/SoundHelix-Song-2.mp3' },
                    { title: 'Detroit Techno Mix 01', artist: 'Various Artists', duration: 420, url: 'https://www.soundhelix.com/examples/mp3/SoundHelix-Song-3.mp3' },
                    { title: 'Underground Resistance Set', artist: 'UR', duration: 380, url: 'https://www.soundhelix.com/examples/mp3/SoundHelix-Song-4.mp3' },
                    { title: 'Juan Atkins - Classics', artist: 'Juan Atkins', duration: 360, url: 'https://www.soundhelix.com/examples/mp3/SoundHelix-Song-5.mp3' }
                ],
                'industrial-techno': [
                    { title: 'HAOS - Rave Rage', artist: 'HAOS', duration: 420, url: 'https://www.soundhelix.com/examples/mp3/SoundHelix-Song-1.mp3' },
                    { title: 'HAOS - Industrial Mix', artist: 'HAOS', duration: 450, url: 'https://www.soundhelix.com/examples/mp3/SoundHelix-Song-6.mp3' },
                    { title: 'Hard Industrial Mix', artist: 'Various Artists', duration: 480, url: 'https://www.soundhelix.com/examples/mp3/SoundHelix-Song-7.mp3' },
                    { title: 'Berghain Sound', artist: 'Various Artists', duration: 420, url: 'https://www.soundhelix.com/examples/mp3/SoundHelix-Song-8.mp3' },
                    { title: 'Dark Techno Selection', artist: 'Various Artists', duration: 390, url: 'https://www.soundhelix.com/examples/mp3/SoundHelix-Song-9.mp3' }
                ],
                'acid-classics': [
                    { title: 'HAOS - Acid Session', artist: 'HAOS', duration: 320, url: 'https://www.soundhelix.com/examples/mp3/SoundHelix-Song-10.mp3' },
                    { title: 'TB-303 Anthology', artist: 'Various Artists', duration: 300, url: 'https://www.soundhelix.com/examples/mp3/SoundHelix-Song-11.mp3' },
                    { title: 'Acid House Classics', artist: 'Various Artists', duration: 330, url: 'https://www.soundhelix.com/examples/mp3/SoundHelix-Song-12.mp3' },
                    { title: 'Squelchy Basslines', artist: 'Various Artists', duration: 290, url: 'https://www.soundhelix.com/examples/mp3/SoundHelix-Song-13.mp3' }
                ],
                'deep-techno': [
                    { title: 'HAOS - Deep Journey', artist: 'HAOS', duration: 600, url: 'https://www.soundhelix.com/examples/mp3/SoundHelix-Song-14.mp3' },
                    { title: 'Deep Techno Journey', artist: 'Various Artists', duration: 540, url: 'https://www.soundhelix.com/examples/mp3/SoundHelix-Song-15.mp3' },
                    { title: 'Hypnotic Grooves', artist: 'Various Artists', duration: 480, url: 'https://www.soundhelix.com/examples/mp3/SoundHelix-Song-16.mp3' },
                    { title: 'Minimal Deep Set', artist: 'Various Artists', duration: 510, url: 'https://www.soundhelix.com/examples/mp3/SoundHelix-Song-17.mp3' }
                ],
                'haos-exclusive': [
                    { title: 'HAOS - Rave Rage', artist: 'HAOS', duration: 420, url: 'https://www.soundhelix.com/examples/mp3/SoundHelix-Song-1.mp3' },
                    { title: 'HAOS - Exclusive Track 1', artist: 'HAOS', duration: 380, url: 'https://www.soundhelix.com/examples/mp3/SoundHelix-Song-2.mp3' },
                    { title: 'HAOS - Exclusive Track 2', artist: 'HAOS', duration: 400, url: 'https://www.soundhelix.com/examples/mp3/SoundHelix-Song-3.mp3' },
                    { title: 'HAOS - Exclusive Track 3', artist: 'HAOS', duration: 360, url: 'https://www.soundhelix.com/examples/mp3/SoundHelix-Song-4.mp3' },
                    { title: 'HAOS - Exclusive Track 4', artist: 'HAOS', duration: 420, url: 'https://www.soundhelix.com/examples/mp3/SoundHelix-Song-5.mp3' },
                    { title: 'HAOS - Exclusive Track 5', artist: 'HAOS', duration: 390, url: 'https://www.soundhelix.com/examples/mp3/SoundHelix-Song-6.mp3' }
                ],
                'youtube-radio': [
                    { title: 'YouTube Radio - Live Mix', artist: 'HAOS YouTube Channel', duration: 10142, url: 'https://www.youtube.com/watch?v=sH4o0fTXCLI&list=RDsH4o0fTXCLI&start_radio=1&t=10142s', isYouTube: true }
                ]
            },

            audioElement: null,
            progressInterval: null,
            isMinimized: false,
            minimizeTimeout: null,

            async init() {
                console.log('üéµ Initializing HAOS Background Radio Player');
                
                // Create audio element
                this.audioElement = new Audio();
                this.audioElement.volume = this.volume / 100;
                
                // Audio event listeners
                this.audioElement.addEventListener('ended', () => {
                    console.log('üéµ Track ended, playing next');
                    this.next();
                });
                
                this.audioElement.addEventListener('error', (e) => {
                    console.error('‚ùå Audio error:', e);
                    console.log('‚è≠Ô∏è Skipping to next track');
                    setTimeout(() => this.next(), 1000);
                });
                
                // Setup expanded controls
                document.getElementById('haos-music-playpause')?.addEventListener('click', () => this.togglePlay());
                document.getElementById('haos-music-next')?.addEventListener('click', () => this.next());
                document.getElementById('haos-music-prev')?.addEventListener('click', () => this.prev());
                document.getElementById('haos-music-volume')?.addEventListener('input', (e) => this.setVolume(e.target.value));
                document.getElementById('haos-music-close')?.addEventListener('click', () => this.close());
                
                // Setup minimized controls
                document.getElementById('haos-mini-playpause')?.addEventListener('click', (e) => {
                    e.stopPropagation();
                    this.togglePlay();
                });
                
                // Setup hover to expand/minimize
                const playerEl = document.getElementById('haos-bg-music-player');
                const minimizedEl = document.getElementById('haos-radio-minimized');
                
                if (playerEl && minimizedEl) {
                    // Click minimized to expand
                    minimizedEl.addEventListener('click', () => {
                        this.expand();
                    });
                    
                    // Hover to expand
                    playerEl.addEventListener('mouseenter', () => {
                        if (this.isMinimized) {
                            this.expand();
                        }
                    });
                    
                    // Leave to minimize (with delay)
                    playerEl.addEventListener('mouseleave', () => {
                        if (this.isMinimized) {
                            setTimeout(() => this.minimize(), 500);
                        }
                    });
                }
                
                // Load uploaded tracks first, or fallback to HAOS Exclusive
                await this.loadDefaultPlaylist();
                this.updateDisplay();
                
                // Show the radio player widget (expanded initially)
                if (playerEl) {
                    playerEl.style.display = 'block';
                    this.showExpanded();
                    console.log('üìª Radio player widget displayed');
                }
                
                // Auto-play with user interaction (click anywhere to start)
                const startAudio = () => {
                    console.log('üéµ User interaction detected, starting playback...');
                    this.play().then(() => {
                        // Minimize after 3 seconds of playback
                        console.log('‚è±Ô∏è Starting 3-second timer to minimize player...');
                        this.minimizeTimeout = setTimeout(() => {
                            this.minimize();
                        }, 3000);
                    });
                    document.removeEventListener('click', startAudio);
                };
                
                // Try auto-play immediately
                setTimeout(() => {
                    console.log('üéµ Attempting auto-play...');
                    this.play().catch(() => {
                        console.log('üéµ Auto-play blocked, waiting for user interaction');
                        document.addEventListener('click', startAudio, { once: true });
                        // Show notification
                        const notification = document.createElement('div');
                        notification.style.cssText = 'position:fixed;top:20px;right:20px;background:linear-gradient(135deg,#FF6B35,#F7931E);color:#000;padding:15px 25px;border-radius:8px;font-family:Space Mono,monospace;font-weight:bold;z-index:10000;box-shadow:0 4px 12px rgba(0,0,0,0.3);animation:slideIn 0.5s ease;';
                        notification.innerHTML = 'üéµ Click anywhere to start HAOS Radio üìª';
                        document.body.appendChild(notification);
                        setTimeout(() => notification.remove(), 5000);
                    });
                }, 500);
            },

            loadPlaylist(playlistId) {
                if (this.playlists[playlistId]) {
                    this.currentPlaylist = playlistId;
                    this.currentTrackIndex = 0;
                    this.updateDisplay();
                    console.log(`üìª Loaded playlist: ${playlistId} (${this.playlists[playlistId].length} tracks)`);
                }
            },

            async loadDefaultPlaylist() {
                try {
                    console.log('üìª Loading default playlist...');
                    // Try to load uploaded tracks first
                    const response = await fetch('/api/tracks/list');
                    const data = await response.json();
                    
                    console.log('üìä API Response:', data);
                    
                    if (data.tracks && data.tracks.length > 0) {
                        // Load uploaded tracks as default
                        this.playlists['uploaded'] = data.tracks.map(track => ({
                            title: track.title,
                            artist: track.artist,
                            duration: track.duration,
                            url: track.url
                        }));
                        this.currentPlaylist = 'uploaded';
                        this.currentTrackIndex = 0;
                        console.log(`‚úÖ Loaded ${data.tracks.length} uploaded track(s) as default playlist`);
                        console.log('üéµ First track:', this.playlists['uploaded'][0]);
                        return true;
                    } else {
                        // Fallback to HAOS Exclusive
                        this.currentPlaylist = 'haos-exclusive';
                        this.currentTrackIndex = 0;
                        console.log('üìª No uploaded tracks, using HAOS Exclusive as default');
                        return false;
                    }
                } catch (error) {
                    console.error('‚ùå Error loading uploaded tracks:', error);
                    // Fallback to HAOS Exclusive on error
                    this.currentPlaylist = 'haos-exclusive';
                    this.currentTrackIndex = 0;
                    return false;
                }
            },

            async play() {
                const track = this.getCurrentTrack();
                
                // Load and play audio
                if (this.audioElement.src !== track.url) {
                    this.audioElement.src = track.url;
                }
                
                try {
                    await this.audioElement.play();
                    this.isPlaying = true;
                    document.getElementById('haos-music-playpause').innerHTML = '<i class="fas fa-pause"></i>';
                    document.getElementById('haos-mini-playpause').innerHTML = '<i class="fas fa-pause"></i>';
                    this.updateDisplay();
                    this.startProgressTracking();
                    console.log('‚ñ∂Ô∏è Playing:', track.title);
                } catch (error) {
                    console.error('‚ùå Playback failed:', error);
                    throw error;
                }
            },

            pause() {
                this.audioElement.pause();
                this.isPlaying = false;
                document.getElementById('haos-music-playpause').innerHTML = '<i class="fas fa-play"></i>';
                document.getElementById('haos-mini-playpause').innerHTML = '<i class="fas fa-play"></i>';
                this.stopProgressTracking();
                console.log('‚è∏Ô∏è Paused');
            },

            togglePlay() {
                if (this.isPlaying) {
                    this.pause();
                } else {
                    this.play();
                }
            },

            minimize() {
                console.log('üîΩ Minimizing radio player');
                this.isMinimized = true;
                document.getElementById('haos-music-controls').style.display = 'none';
                document.getElementById('haos-radio-minimized').style.display = 'block';
                
                // Adjust player container width for minimized state
                const playerEl = document.getElementById('haos-bg-music-player');
                if (playerEl) {
                    playerEl.style.width = 'auto';
                    playerEl.style.maxWidth = '350px';
                }
            },

            expand() {
                console.log('üîº Expanding radio player');
                this.isMinimized = false;
                this.showExpanded();
                
                // Cancel minimize timeout if exists
                if (this.minimizeTimeout) {
                    clearTimeout(this.minimizeTimeout);
                    this.minimizeTimeout = null;
                }
            },

            showExpanded() {
                document.getElementById('haos-radio-minimized').style.display = 'none';
                document.getElementById('haos-music-controls').style.display = 'block';
                
                // Reset player container width
                const playerEl = document.getElementById('haos-bg-music-player');
                if (playerEl) {
                    playerEl.style.width = '400px';
                    playerEl.style.maxWidth = '90vw';
                }
            },

            next() {
                const playlist = this.playlists[this.currentPlaylist];
                this.currentTrackIndex = (this.currentTrackIndex + 1) % playlist.length;
                this.updateDisplay();
                if (this.isPlaying) {
                    this.play();
                    console.log('‚è≠Ô∏è Next track:', this.getCurrentTrack().title);
                }
            },

            prev() {
                const playlist = this.playlists[this.currentPlaylist];
                this.currentTrackIndex = (this.currentTrackIndex - 1 + playlist.length) % playlist.length;
                this.updateDisplay();
                if (this.isPlaying) {
                    this.play();
                    console.log('‚èÆÔ∏è Previous track:', this.getCurrentTrack().title);
                }
            },

            getCurrentTrack() {
                return this.playlists[this.currentPlaylist][this.currentTrackIndex];
            },

            updateDisplay() {
                const track = this.getCurrentTrack();
                const playlistName = this.getPlaylistName();
                
                // Update expanded view
                document.getElementById('haos-track-title').textContent = track.title;
                document.getElementById('haos-track-artist').textContent = track.artist + ' ‚Ä¢ ' + playlistName;
                
                // Update minimized view
                document.getElementById('haos-mini-title').textContent = track.title;
                document.getElementById('haos-mini-artist').textContent = track.artist + ' ‚Ä¢ ' + playlistName;
                
                // Sync play/pause buttons
                const iconHTML = this.isPlaying ? '<i class="fas fa-pause"></i>' : '<i class="fas fa-play"></i>';
                document.getElementById('haos-music-playpause').innerHTML = iconHTML;
                document.getElementById('haos-mini-playpause').innerHTML = iconHTML;
            },

            getPlaylistName() {
                const names = {
                    'technobot-detroit': 'Technobot Detroit',
                    'industrial-techno': 'Industrial Techno',
                    'acid-classics': 'Acid Classics',
                    'deep-techno': 'Deep Techno',
                    'haos-exclusive': 'üéµ HAOS Artist Exclusive',
                    'uploaded': 'üìÅ Your Uploaded Tracks'
                };
                return names[this.currentPlaylist] || 'HAOS Radio';
            },

            setVolume(value) {
                this.volume = parseInt(value);
                this.audioElement.volume = this.volume / 100;
                console.log('üîä Volume:', this.volume + '%');
            },

            startProgressTracking() {
                this.stopProgressTracking();
                this.progressInterval = setInterval(() => {
                    if (this.audioElement.duration > 0) {
                        const percent = (this.audioElement.currentTime / this.audioElement.duration) * 100;
                        document.getElementById('haos-music-progress').style.width = percent + '%';
                    }
                }, 500);
            },

            stopProgressTracking() {
                if (this.progressInterval) {
                    clearInterval(this.progressInterval);
                    this.progressInterval = null;
                }
            },

            close() {
                const playerEl = document.getElementById('haos-bg-music-player');
                if (playerEl) {
                    playerEl.style.display = 'none';
                }
                this.pause();
                console.log('üìª Radio player closed');
            },

            // Cycle through playlists
            switchPlaylist() {
                const playlists = Object.keys(this.playlists);
                const currentIndex = playlists.indexOf(this.currentPlaylist);
                const nextIndex = (currentIndex + 1) % playlists.length;
                this.loadPlaylist(playlists[nextIndex]);
                if (this.isPlaying) {
                    this.play();
                }
            }
        };

        // Create local reference for convenience
        const HAOS_BG_RADIO = window.HAOS_BG_RADIO;

        // Initialize radio on page load
        document.addEventListener('DOMContentLoaded', () => {
            HAOS_BG_RADIO.init();
            
            // Add playlist switcher (optional - click on "NOW PLAYING" to switch)
            document.querySelector('#haos-music-controls').addEventListener('dblclick', () => {
                HAOS_BG_RADIO.switchPlaylist();
            });
        });

        // ====================================================================
        // ====================================================================
        // EUPHONY AI ASSISTANT - Intelligent Music System
        // ====================================================================
        const EUPHONY = {
            chatHistory: [],
            database: {
                presets: { tb303: 17, tr909: 9, tr808: 10, arp2600: 14 },
                totalPresets: 50,
                tracks: 26,
                playlists: {
                    'haos-exclusive': { name: 'HAOS Exclusive', tracks: 6, genre: 'Original' },
                    'technobot-detroit': { name: 'Technobot Detroit', tracks: 5, genre: 'Detroit Techno' },
                    'industrial-techno': { name: 'Industrial Techno', tracks: 5, genre: 'Industrial' },
                    'acid-classics': { name: 'Acid Classics', tracks: 4, genre: 'Acid House' },
                    'deep-techno': { name: 'Deep Techno', tracks: 4, genre: 'Deep/Hypnotic' },
                    'soundcloud-radio': { name: 'SoundCloud Radio', tracks: 1, genre: 'Electronic', url: 'https://soundcloud.com/haos-fm' }
                }
            },
            
            async loadUploadedTracks() {
                try {
                    console.log('üéß Fetching uploaded tracks from API...');
                    console.log('üîç HAOS_BG_RADIO exists?', !!window.HAOS_BG_RADIO);
                    console.log('üîç HAOS_BG_RADIO.playlists exists?', window.HAOS_BG_RADIO?.playlists);
                    
                    const response = await fetch('/api/tracks/list');
                    const data = await response.json();
                    
                    console.log('üìä Tracks data:', data);
                    
                    if (data.tracks && data.tracks.length > 0) {
                        // Create playlist from uploaded tracks
                        if (window.HAOS_BG_RADIO) {
                            // Initialize playlists object if it doesn't exist
                            if (!window.HAOS_BG_RADIO.playlists) {
                                console.log('‚ö†Ô∏è Playlists object missing, initializing...');
                                window.HAOS_BG_RADIO.playlists = {};
                            }
                            
                            const playlist = data.tracks.map(track => ({
                                title: track.title,
                                artist: track.artist,
                                duration: track.duration,
                                url: track.url
                            }));
                            
                            console.log('üéµ Created playlist:', playlist);
                            window.HAOS_BG_RADIO.playlists['uploaded'] = playlist;
                            
                            console.log('üìª Loading playlist "uploaded"...');
                            HAOS_BG_RADIO.loadPlaylist('uploaded');
                            
                            console.log('‚ñ∂Ô∏è Starting playback...');
                            await HAOS_BG_RADIO.play();
                            
                            this.addMessage('assistant', `üéß <strong>Your Uploaded Tracks</strong> loaded!\nüìÅ ${data.tracks.length} track(s) ready to play.\nüéµ Now playing: ${data.tracks[0].title} by ${data.tracks[0].artist}`);
                        } else {
                            console.error('‚ùå HAOS_BG_RADIO not available');
                            this.addMessage('assistant', '‚ùå Player not initialized. Please refresh the page.');
                        }
                    } else {
                        console.log('üìÅ No tracks found');
                        this.addMessage('assistant', 'üìÅ No uploaded tracks found. Use the upload button to add your tracks!');
                    }
                } catch (error) {
                    console.error('‚ùå Error loading uploaded tracks:', error);
                    this.addMessage('assistant', `‚ùå Error loading uploaded tracks: ${error.message}`);
                }
            },
            
            init() {
                console.log('üéµ Euphony AI Music Intelligence initialized');
                console.log(`üìä Database: ${this.database.totalPresets} presets, ${this.database.tracks} tracks, 6 playlists`);
                
                // Setup event listeners
                document.getElementById('euphony-send')?.addEventListener('click', () => this.sendCommand());
                document.getElementById('euphony-input')?.addEventListener('keypress', (e) => {
                    if (e.key === 'Enter') this.sendCommand();
                });
                
                // Quick command buttons
                document.querySelectorAll('.euphony-quick-btn').forEach(btn => {
                    btn.addEventListener('click', () => {
                        const command = btn.getAttribute('data-command');
                        document.getElementById('euphony-input').value = command;
                        this.sendCommand();
                    });
                });
                
                // Minimize/maximize
                document.getElementById('euphony-minimize')?.addEventListener('click', () => this.minimize());
                document.getElementById('euphony-minimized')?.addEventListener('click', () => this.maximize());
            },
            
            sendCommand() {
                const input = document.getElementById('euphony-input');
                const command = input.value.trim().toLowerCase();
                
                if (!command) return;
                
                // Add user message
                this.addMessage('user', command);
                input.value = '';
                
                // Process command
                this.processCommand(command);
            },
            
            async processCommand(cmd) {
                let response = '';
                
                // Preset database queries
                if (cmd.includes('show') || cmd.includes('list')) {
                    if (cmd.includes('tb303') || cmd.includes('303')) {
                        response = `üéπ <strong>TB-303 Presets (${this.database.presets.tb303})</strong>:\nAcid bass synthesizer presets including classic squelch, resonant bass, and acid leads. Categories: Classic, Bass, Lead, FX.`;
                    } else if (cmd.includes('arp2600') || cmd.includes('arp') || cmd.includes('2600')) {
                        response = `üéπ <strong>ARP 2600 Patches (${this.database.presets.arp2600})</strong>:\nFull modular patch cables including:\n‚Ä¢ 5 Bass patches (Sub Bass, Acid, Reese, Wobble)\n‚Ä¢ 2 Lead patches (Arpeggio, Vintage)\n‚Ä¢ 2 Percussion (Hi-Hat, Snare)\n‚Ä¢ 2 FX (Phaser, Random S&H)\n‚Ä¢ 1 Pad (Dark Atmospheric)\nEach with complete cable routing!`;
                    } else if (cmd.includes('tr909') || cmd.includes('909')) {
                        response = `ü•Å <strong>TR-909 Drum Kits (${this.database.presets.tr909})</strong>:\nClassic drum machine patterns. Categories: Classic, Techno, Minimal, Hard.`;
                    } else if (cmd.includes('tr808') || cmd.includes('808')) {
                        response = `ü•Å <strong>TR-808 Drum Kits (${this.database.presets.tr808})</strong>:\nLegendary 808 sounds. Categories: Classic, Hip-Hop, Trap, Electronic.`;
                    } else if (cmd.includes('preset') || cmd.includes('all')) {
                        response = `üì¶ <strong>Complete Preset Database</strong>:\n‚Ä¢ TB-303: ${this.database.presets.tb303} presets\n‚Ä¢ ARP 2600: ${this.database.presets.arp2600} patches\n‚Ä¢ TR-909: ${this.database.presets.tr909} kits\n‚Ä¢ TR-808: ${this.database.presets.tr808} kits\n<strong>Total: ${this.database.totalPresets} factory presets</strong>`;
                    } else {
                        response = `üìä <strong>Available Categories</strong>:\n‚Ä¢ "show tb303" - Acid bass presets\n‚Ä¢ "show arp2600" - Modular patches\n‚Ä¢ "show tr909" - Drum kits\n‚Ä¢ "show tr808" - 808 kits`;
                    }
                }
                // Special track commands
                else if (cmd.includes('rave rage') || cmd.includes('raverage')) {
                    HAOS_BG_RADIO.loadPlaylist('haos-exclusive');
                    HAOS_BG_RADIO.currentTrackIndex = 0;
                    HAOS_BG_RADIO.play();
                    response = 'üî• <strong>HAOS - Rave Rage</strong> is ON! The signature track is playing! üéµ‚ö°';
                }
                // Playlist commands
                else if (cmd.includes('play') || cmd.includes('load')) {
                    if (cmd.includes('uploaded') || cmd.includes('my tracks') || cmd.includes('custom')) {
                        // Load uploaded tracks
                        await this.loadUploadedTracks();
                        return; // loadUploadedTracks() handles its own messaging
                    } else if (cmd.includes('soundcloud') || cmd.includes('radio') || cmd.includes('live')) {
                        // Show SoundCloud player
                        const player = document.getElementById('soundcloud-player-container');
                        if (player) {
                            player.style.display = 'block';
                            response = `üéß <strong>${this.database.playlists['soundcloud-radio'].name}</strong> is playing!\nüéµ Embedded player loaded\nüîä Continuous HAOS music streaming!\nüé∂ Enjoy the mix!`;
                        }
                    } else if (cmd.includes('haos') || cmd.includes('exclusive')) {
                        HAOS_BG_RADIO.loadPlaylist('haos-exclusive');
                        HAOS_BG_RADIO.play();
                        response = `üéµ <strong>${this.database.playlists['haos-exclusive'].name}</strong> loaded!\n${this.database.playlists['haos-exclusive'].tracks} original HAOS tracks starting with Rave Rage!`;
                    } else if (cmd.includes('detroit') || cmd.includes('techno')) {
                        HAOS_BG_RADIO.loadPlaylist('technobot-detroit');
                        HAOS_BG_RADIO.play();
                        response = `‚ö° <strong>${this.database.playlists['technobot-detroit'].name}</strong> activated!\nClassic Detroit techno - ${this.database.playlists['technobot-detroit'].tracks} tracks.`;
                    } else if (cmd.includes('industrial')) {
                        HAOS_BG_RADIO.loadPlaylist('industrial-techno');
                        HAOS_BG_RADIO.play();
                        response = `üè≠ <strong>${this.database.playlists['industrial-techno'].name}</strong> loaded!\nHard and dark beats - ${this.database.playlists['industrial-techno'].tracks} tracks.`;
                    } else if (cmd.includes('acid')) {
                        HAOS_BG_RADIO.loadPlaylist('acid-classics');
                        HAOS_BG_RADIO.play();
                        response = `üß™ <strong>${this.database.playlists['acid-classics'].name}</strong> engaged!\nTB-303 squelches - ${this.database.playlists['acid-classics'].tracks} tracks.`;
                    } else if (cmd.includes('deep')) {
                        HAOS_BG_RADIO.loadPlaylist('deep-techno');
                        HAOS_BG_RADIO.play();
                        response = `üåä <strong>${this.database.playlists['deep-techno'].name}</strong> started!\nHypnotic grooves - ${this.database.playlists['deep-techno'].tracks} tracks.`;
                    } else {
                        response = 'üéµ Please specify a playlist: youtube, haos, detroit, industrial, acid, or deep.';
                    }
                }
                // Playback controls
                else if (cmd === 'play' || cmd === 'start' || cmd.includes('resume')) {
                    HAOS_BG_RADIO.play();
                    response = '‚ñ∂Ô∏è Playback started!';
                }
                else if (cmd === 'pause' || cmd === 'stop') {
                    HAOS_BG_RADIO.pause();
                    response = '‚è∏Ô∏è Playback paused.';
                }
                else if (cmd === 'next' || cmd.includes('skip')) {
                    HAOS_BG_RADIO.next();
                    response = '‚è≠Ô∏è Skipped to next track!';
                }
                else if (cmd === 'previous' || cmd === 'prev' || cmd.includes('back')) {
                    HAOS_BG_RADIO.prev();
                    response = '‚èÆÔ∏è Going back to previous track!';
                }
                // Shuffle
                else if (cmd.includes('shuffle') || cmd.includes('random')) {
                    HAOS_BG_RADIO.switchPlaylist();
                    response = 'üé≤ Random playlist loaded! Discovering new sounds...';
                }
                // Volume control
                else if (cmd.includes('volume')) {
                    const match = cmd.match(/\d+/);
                    if (match) {
                        const vol = parseInt(match[0]);
                        HAOS_BG_RADIO.setVolume(vol);
                        document.getElementById('haos-music-volume').value = vol;
                        response = `üîä Volume adjusted to ${vol}%`;
                    } else {
                        response = 'üîä Current volume: ' + HAOS_BG_RADIO.volume + '%';
                    }
                }
                // Status
                else if (cmd.includes('status') || cmd.includes('info') || cmd.includes('what') || cmd.includes('now playing')) {
                    const track = HAOS_BG_RADIO.getCurrentTrack();
                    const playlist = HAOS_BG_RADIO.getPlaylistName();
                    const state = HAOS_BG_RADIO.isPlaying ? 'Playing' : 'Paused';
                    const playlistInfo = this.database.playlists[HAOS_BG_RADIO.currentPlaylist];
                    response = `üìä <strong>Status</strong>:\n‚ñ∂Ô∏è ${state}\nüéµ "${track.title}" by ${track.artist}\nüìª ${playlist} (${playlistInfo.genre})\nüîä Volume: ${HAOS_BG_RADIO.volume}%`;
                }
                // Database stats
                else if (cmd.includes('stats') || cmd.includes('database')) {
                    response = `üìä <strong>HAOS Database Statistics</strong>:\nüéπ ${this.database.totalPresets} Factory Presets\nüéµ ${this.database.tracks} Music Tracks\nüìª 5 Curated Playlists\nüé® 4 Synthesizer Types\n‚ö° Powered by Euphony AI`;
                }
                // Help
                else if (cmd.includes('help') || cmd.includes('commands')) {
                    response = `ÔøΩ <strong>Euphony AI Commands</strong>:\n\n<strong>Presets</strong>: show [tb303|arp2600|tr909|tr808]\n<strong>Playlists</strong>: play [haos|detroit|industrial|acid|deep]\n<strong>Controls</strong>: next, prev, pause, shuffle\n<strong>Info</strong>: status, stats, help`;
                }
                // Default
                else {
                    response = `ü§î I didn't recognize "${cmd}". Try <strong>"help"</strong> to see all available commands, or <strong>"show presets"</strong> to browse the database!`;
                }
                
                // Add bot response
                this.addMessage('bot', response);
            },
            
            addMessage(type, text) {
                const chat = document.getElementById('euphony-chat');
                const msg = document.createElement('div');
                msg.className = 'euphony-message';
                msg.style.marginBottom = '10px';
                msg.style.lineHeight = '1.6';
                
                if (type === 'user') {
                    msg.style.color = '#00D9FF';
                    msg.innerHTML = `<strong>üë§ You:</strong> ${text}`;
                } else {
                    msg.style.color = '#BA55D3';
                    msg.innerHTML = `<strong>üéµ Euphony:</strong> ${text.replace(/\n/g, '<br>')}`;
                }
                
                chat.appendChild(msg);
                chat.scrollTop = chat.scrollHeight;
                
                // Keep only last 25 messages (larger history)
                while (chat.children.length > 25) {
                    chat.removeChild(chat.firstChild);
                }
            },
            
            minimize() {
                document.getElementById('euphony-panel').style.display = 'none';
                document.getElementById('euphony-minimized').style.display = 'flex';
            },
            
            maximize() {
                document.getElementById('euphony-panel').style.display = 'block';
                document.getElementById('euphony-minimized').style.display = 'none';
            }
        };

        // Initialize Euphony
        document.addEventListener('DOMContentLoaded', () => {
            EUPHONY.init();
            initTrackUpload();
        });

        // ============================================================================
        // TRACK UPLOAD FUNCTIONALITY
        // ============================================================================
        function initTrackUpload() {
            const uploadPanel = document.getElementById('track-upload-panel');
            const openBtn = document.getElementById('open-upload-btn');
            const closeBtn = document.getElementById('upload-panel-close');
            const uploadForm = document.getElementById('track-upload-form');
            const fileInput = document.getElementById('track-file');
            const fileInfo = document.getElementById('file-info');
            const uploadStatus = document.getElementById('upload-status');
            const submitBtn = document.getElementById('upload-submit-btn');

            // Open upload panel
            openBtn.addEventListener('click', () => {
                uploadPanel.style.display = 'block';
            });

            // Close upload panel
            closeBtn.addEventListener('click', () => {
                uploadPanel.style.display = 'none';
                uploadForm.reset();
                fileInfo.textContent = '';
                uploadStatus.style.display = 'none';
            });

            // File input change - show file info
            fileInput.addEventListener('change', (e) => {
                const files = e.target.files;
                if (files && files.length > 0) {
                    if (files.length === 1) {
                        const file = files[0];
                        const sizeMB = (file.size / (1024 * 1024)).toFixed(2);
                        fileInfo.textContent = `üìÅ ${file.name} (${sizeMB} MB)`;
                        fileInfo.style.color = '#FF5500';
                    } else {
                        let totalSize = 0;
                        for (let i = 0; i < files.length; i++) {
                            totalSize += files[i].size;
                        }
                        const totalSizeMB = (totalSize / (1024 * 1024)).toFixed(2);
                        fileInfo.innerHTML = `üìÅ <strong>${files.length} files</strong> selected (${totalSizeMB} MB total)<br>`;
                        fileInfo.innerHTML += `<div style="margin-top:5px; max-height:100px; overflow-y:auto;">`;
                        for (let i = 0; i < files.length; i++) {
                            const sizeMB = (files[i].size / (1024 * 1024)).toFixed(2);
                            fileInfo.innerHTML += `<div style="font-size:0.7rem; opacity:0.8;">‚Ä¢ ${files[i].name} (${sizeMB} MB)</div>`;
                        }
                        fileInfo.innerHTML += `</div>`;
                        fileInfo.style.color = '#FF5500';
                    }
                }
            });

            // Form submission - handle single or multiple files
            uploadForm.addEventListener('submit', async (e) => {
                e.preventDefault();

                // Validate copyright checkbox
                const copyrightCheckbox = document.getElementById('track-copyright');
                if (!copyrightCheckbox.checked) {
                    uploadStatus.style.display = 'block';
                    uploadStatus.style.color = '#FF0000';
                    uploadStatus.innerHTML = '‚ùå <strong>Copyright confirmation required</strong><br>You must confirm that you own the copyright to upload tracks.';
                    return;
                }

                // Validate files are selected
                if (!fileInput.files || fileInput.files.length === 0) {
                    uploadStatus.style.display = 'block';
                    uploadStatus.style.color = '#FF0000';
                    uploadStatus.textContent = '‚ùå Please select at least one audio file';
                    return;
                }

                const files = Array.from(fileInput.files);
                const title = document.getElementById('track-title').value.trim();
                const artist = document.getElementById('track-artist').value.trim();
                const genre = document.getElementById('track-genre').value;
                
                // Disable submit button
                submitBtn.disabled = true;
                submitBtn.textContent = '‚è≥ UPLOADING...';
                submitBtn.style.opacity = '0.6';
                
                // Show status
                uploadStatus.style.display = 'block';
                uploadStatus.style.color = '#FFD700';
                
                if (files.length === 1) {
                    // Single file upload
                    uploadStatus.textContent = '‚è≥ Uploading track to HAOS.fm...';
                    
                    const formData = new FormData();
                    formData.append('audioFile', files[0]);
                    formData.append('title', title || files[0].name.replace(/\.[^/.]+$/, ''));
                    formData.append('artist', artist || 'Unknown Artist');
                    formData.append('genre', genre);
                    formData.append('copyright', 'on'); // Copyright checkbox confirmed

                    try {
                        const response = await fetch('/api/tracks/upload', {
                            method: 'POST',
                            body: formData
                        });

                        const result = await response.json();

                        if (response.ok) {
                            uploadStatus.style.color = '#00FF00';
                            uploadStatus.innerHTML = `‚úÖ <strong>Success!</strong><br>Track "${result.track.title}" uploaded successfully!<br>Duration: ${result.track.duration}s`;
                            
                            // Reload uploaded tracks in radio player
                            if (window.HAOS_BG_RADIO) {
                                await window.HAOS_BG_RADIO.loadDefaultPlaylist();
                                window.HAOS_BG_RADIO.updateDisplay();
                            }
                            
                            // Reset form after 3 seconds
                            setTimeout(() => {
                                uploadForm.reset();
                                fileInfo.textContent = '';
                                uploadPanel.style.display = 'none';
                            }, 3000);
                        } else {
                            throw new Error(result.error || 'Upload failed');
                        }
                    } catch (error) {
                        uploadStatus.style.color = '#FF0000';
                        uploadStatus.textContent = '‚ùå Upload failed: ' + error.message;
                    }
                } else {
                    // Multiple files - bulk upload
                    uploadStatus.innerHTML = `‚è≥ Uploading ${files.length} tracks...<br><div id="bulk-progress" style="margin-top:8px;"></div>`;
                    const progressDiv = document.getElementById('bulk-progress');
                    
                    let successCount = 0;
                    let failCount = 0;
                    
                    for (let i = 0; i < files.length; i++) {
                        const file = files[i];
                        const fileName = file.name.replace(/\.[^/.]+$/, '');
                        
                        progressDiv.innerHTML += `<div style="font-size:0.75rem; opacity:0.8;">‚è≥ Uploading ${i + 1}/${files.length}: ${file.name}...</div>`;
                        
                        const formData = new FormData();
                        formData.append('audioFile', file);
                        formData.append('title', title || fileName);
                        formData.append('artist', artist || 'Unknown Artist');
                        formData.append('genre', genre);
                        formData.append('copyright', 'on'); // Copyright checkbox confirmed

                        try {
                            const response = await fetch('/api/tracks/upload', {
                                method: 'POST',
                                body: formData
                            });

                            const result = await response.json();

                            if (response.ok) {
                                successCount++;
                                progressDiv.lastChild.innerHTML = `‚úÖ ${i + 1}/${files.length}: ${result.track.title} (${result.track.duration}s)`;
                                progressDiv.lastChild.style.color = '#00FF00';
                            } else {
                                failCount++;
                                progressDiv.lastChild.innerHTML = `‚ùå ${i + 1}/${files.length}: ${file.name} - ${result.error}`;
                                progressDiv.lastChild.style.color = '#FF6B6B';
                            }
                        } catch (error) {
                            failCount++;
                            progressDiv.lastChild.innerHTML = `‚ùå ${i + 1}/${files.length}: ${file.name} - ${error.message}`;
                            progressDiv.lastChild.style.color = '#FF6B6B';
                        }
                    }
                    
                    // Final status
                    uploadStatus.style.color = successCount > 0 ? '#00FF00' : '#FF0000';
                    uploadStatus.innerHTML = `<strong>${successCount > 0 ? '‚úÖ Bulk Upload Complete!' : '‚ùå Upload Failed'}</strong><br>‚úÖ ${successCount} succeeded, ‚ùå ${failCount} failed<br>${progressDiv.innerHTML}`;
                    
                    // Reload uploaded tracks in radio player
                    if (successCount > 0 && window.HAOS_BG_RADIO) {
                        await window.HAOS_BG_RADIO.loadDefaultPlaylist();
                        window.HAOS_BG_RADIO.updateDisplay();
                        if (!window.HAOS_BG_RADIO.isPlaying) {
                            window.HAOS_BG_RADIO.play();
                        }
                    }
                    
                    // Reset form after 5 seconds for bulk uploads
                    setTimeout(() => {
                        uploadForm.reset();
                        fileInfo.textContent = '';
                        uploadStatus.style.display = 'none';
                        submitBtn.disabled = false;
                        submitBtn.textContent = 'üéµ UPLOAD TRACK';
                        submitBtn.style.opacity = '1';
                    }, 5000);
                }
                
                // Re-enable button for error cases
                submitBtn.disabled = false;
                submitBtn.textContent = 'üéµ UPLOAD TRACK';
                submitBtn.style.opacity = '1';
            });

            console.log('üéß Track upload system initialized');
        }
    </script>
</body>
</html>
